"use strict";(self.webpackChunkangular_dashboard=self.webpackChunkangular_dashboard||[]).push([[421],{3421:(ct,y,c)=>{c.r(y),c.d(y,{DashboardModule:()=>it});var h=c(6895),f=c(3841),a=c(2997),u=c(433),i=c(2655),F=c(7618),U=c(8641),m=c(9018),p=c(2063);const T=(0,a.PH)(p.M.CREATE_BOARD,(0,a.Ky)()),Z=(0,a.PH)(p.M.CREATE_BOARD_SUCCESS,(0,a.Ky)()),O=(0,a.PH)(p.M.EDIT_BOARD,(0,a.Ky)()),E=(0,a.PH)(p.M.EDIT_BOARD_SUCCESS,(0,a.Ky)()),P=(0,a.PH)(p.M.DELETE_BOARD,(0,a.Ky)()),x=(0,a.PH)(p.M.DELETE_BOARD_SUCCESS,(0,a.Ky)()),S=(0,a.PH)(p.M.SELECT_BOARD,(0,a.Ky)());var $=c(8931),L=c(4864);const C=(0,a.PH)(p.M.CLOSE_MODAL),N=(0,a.Lq)({boards:null,currentBoard:null},(0,a.on)(m.Q,(o,n)=>({...o,boards:n.boards})),(0,a.on)(Z,(o,n)=>{const r=[...o.boards];return r.push(n.board),{...o,boards:r}}),(0,a.on)(S,(o,n)=>({...o,currentBoard:n.currentBoard})),(0,a.on)(C,o=>({...o,currentBoard:null})),(0,a.on)(E,(o,n)=>{const r=[...o.boards],e=r.findIndex(d=>d._id===n.updatedBoard._id);return r[e]=n.updatedBoard,{...o,boards:r}}),(0,a.on)($.R,(o,n)=>{const r=[...o.boards];return r.sort("amountOfTasks"===n.sortParam?(e,d)=>{const s=e.lists[0].tasks.length+e.lists[1].tasks.length+e.lists[2].tasks.length,l=d.lists[0].tasks.length+d.lists[1].tasks.length+d.lists[2].tasks.length;return("ASC"===n.sortMode?s<l:s>l)?-1:("ASC"===n.sortMode?s>l:s<l)?1:0}:(e,d)=>{const s=e[`${n.sortParam}`].toLowerCase(),l=d[`${n.sortParam}`].toLowerCase();return("ASC"===n.sortMode?s<l:s>l)?-1:("ASC"===n.sortMode?s>l:s<l)?1:0}),{...o,boards:r}}),(0,a.on)(L.J,(o,n)=>{const r=o.boards.filter(e=>e.name.toLowerCase().includes(n.filter));return{...o,boards:r}}),(0,a.on)(x,(o,n)=>{const r=[...o.boards].filter(e=>e._id!==n.currentBoard._id);return{...o,boards:r}}));function Y(o,n){return N(o,n)}const D=o=>o.dashboard,z=(0,a.P1)(D,o=>o.boards),J=(0,a.P1)(D,o=>o.currentBoard);var t=c(4650),I=c(6444);const v=(0,a.PH)(p.M.OPEN_MODAL),k=(0,a.PH)(p.M.OPEN_BOARD_PAGE,(0,a.Ky)());let w=(()=>{class o{constructor(r){this.store=r}onEditBoard(r){r.stopPropagation(),this.store.dispatch(S({currentBoard:this.board})),this.store.dispatch(v())}onDeleteBoard(r){if(r.stopPropagation(),!this.confirmDeleteBoard())return null;this.store.dispatch(P({currentBoard:this.board}))}confirmDeleteBoard(){return confirm("Do you really want to delete this board?")}onBoardSelected(){this.store.dispatch(k({currentBoard:this.board}))}}return o.\u0275fac=function(r){return new(r||o)(t.Y36(a.yh))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-board-card"]],inputs:{board:"board"},decls:18,vars:8,consts:[[1,"board-card",3,"click"],[1,"board-card__name"],[1,"board-card__tasks"],[1,"board-card__description"],[1,"board-card__date"],[1,"controls"],["type","button",1,"controls__button","controls__button_edit",3,"click"],["type","button",1,"controls__button","controls__button_delete",3,"click"]],template:function(r,e){1&r&&(t.TgZ(0,"div",0),t.NdJ("click",function(){return e.onBoardSelected()}),t.TgZ(1,"h3",1),t._uU(2),t.qZA(),t.TgZ(3,"div",2)(4,"p"),t._uU(5),t.qZA(),t.TgZ(6,"p"),t._uU(7),t.qZA(),t.TgZ(8,"p"),t._uU(9),t.qZA()(),t.TgZ(10,"p",3),t._uU(11),t.qZA(),t.TgZ(12,"p",4),t._uU(13),t.ALo(14,"date"),t.qZA(),t.TgZ(15,"div",5)(16,"button",6),t.NdJ("click",function(s){return e.onEditBoard(s)}),t.qZA(),t.TgZ(17,"button",7),t.NdJ("click",function(s){return e.onDeleteBoard(s)}),t.qZA()()()),2&r&&(t.xp6(2),t.Oqu(e.board.name),t.xp6(3),t.hij("T: ",e.board.lists[0].tasks.length,""),t.xp6(2),t.hij("I: ",e.board.lists[1].tasks.length,""),t.xp6(2),t.hij("D: ",e.board.lists[2].tasks.length,""),t.xp6(2),t.hij(" ",e.board.description," "),t.xp6(2),t.Oqu(t.lcZ(14,6,e.board.createdAt)))},dependencies:[h.uU],styles:[".board-card[_ngcontent-%COMP%]{min-height:170px;background-color:#a7fda0;display:flex;flex-direction:column;justify-content:space-between;padding:10px 20px;cursor:pointer;position:relative;border:1px solid black;box-shadow:1px 1px 5px #000}.board-card[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{margin:0}.board-card__tasks[_ngcontent-%COMP%]{display:flex;gap:5px;position:absolute;top:10px;right:5px;font-size:14px}.board-card__name[_ngcontent-%COMP%]{width:60%}.board-card__date[_ngcontent-%COMP%]{font-style:italic}.board-card[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]{position:absolute;bottom:5px;right:5px;display:flex;gap:7px}.board-card[_ngcontent-%COMP%]   .controls__button[_ngcontent-%COMP%]{background-color:transparent;background-size:cover;border:none;width:30px;height:30px;cursor:pointer}.board-card[_ngcontent-%COMP%]   .controls__button_edit[_ngcontent-%COMP%]{background-image:url(edit-board.9c6ff7e94835e14b.png)}.board-card[_ngcontent-%COMP%]   .controls__button_delete[_ngcontent-%COMP%]{background-image:url(delete-board.f718f2dbd5f2adcd.png)}.board-card[_ngcontent-%COMP%]   .controls__delete[_ngcontent-%COMP%]{background-color:#ff4141}"],changeDetection:0}),o})(),H=(()=>{class o{constructor(r){this.store=r}onModalOpen(){this.store.dispatch(v())}}return o.\u0275fac=function(r){return new(r||o)(t.Y36(a.yh))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-add-board"]],decls:5,vars:0,consts:[[1,"add-board-button",3,"click"],[1,"add-board-button__plus"],[1,"add-board-button__text"]],template:function(r,e){1&r&&(t.TgZ(0,"button",0),t.NdJ("click",function(){return e.onModalOpen()}),t.TgZ(1,"span",1),t._uU(2,"+"),t.qZA(),t.TgZ(3,"p",2),t._uU(4,"Add new"),t.qZA()())},styles:[".add-board-button[_ngcontent-%COMP%]{min-height:170px;background-color:gray;display:flex;flex-direction:column;justify-content:flex-end;padding:20px 50px;border:none;border-radius:15px;position:relative;cursor:pointer}.add-board-button__plus[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:70px}.add-board-button__text[_ngcontent-%COMP%]{justify-self:flex-end;font-size:2em;margin:0}"],changeDetection:0}),o})();function R(o,n){1&o&&t._UZ(0,"app-board-card",2),2&o&&t.Q6J("board",n.$implicit)}let X=(()=>{class o{constructor(r){this.store=r}ngOnInit(){this.store.dispatch((0,m.H)()),this.initializeValues()}initializeValues(){this.boards$=this.store.pipe((0,a.Ys)(z))}}return o.\u0275fac=function(r){return new(r||o)(t.Y36(a.yh))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-dashboard"]],decls:7,vars:3,consts:[[1,"container","dashboard"],[3,"board",4,"ngFor","ngForOf"],[3,"board"]],template:function(r,e){1&r&&(t.TgZ(0,"div"),t._UZ(1,"app-toolbar"),t.TgZ(2,"div",0),t._UZ(3,"app-add-board"),t.YNc(4,R,1,1,"app-board-card",1),t.ALo(5,"async"),t._UZ(6,"router-outlet"),t.qZA()()),2&r&&(t.xp6(4),t.Q6J("ngForOf",t.lcZ(5,1,e.boards$)))},dependencies:[h.sg,f.lC,I.n,w,H,h.Ov],styles:[".dashboard[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,1fr);gap:40px}"],changeDetection:0}),o})();function j(o,n){1&o&&(t.TgZ(0,"span"),t._uU(1," Max length is 15 symbols!"),t.qZA())}function Q(o,n){1&o&&(t.TgZ(0,"span"),t._uU(1," This field is required!"),t.qZA())}function q(o,n){1&o&&(t.TgZ(0,"span"),t._uU(1," This name is forbidden!"),t.qZA())}function K(o,n){1&o&&(t.TgZ(0,"span"),t._uU(1," Max length is 50 symbols!"),t.qZA())}let W=(()=>{class o{constructor(r,e){this.fb=r,this.store=e,this.forbiddenName="Test"}ngOnInit(){this.initializeValues(),this.initializeForm()}initializeForm(){this.modalForm=this.fb.group({name:[this.currentBoard?this.currentBoard.name:"",[u.kI.required,u.kI.maxLength(15),this.forbiddenNameCheck.bind(this)]],description:[this.currentBoard?this.currentBoard.description:"",[u.kI.maxLength(50)]]})}initializeValues(){this.currentBoard$=this.store.pipe((0,a.Ys)(J)),this.currentBoardSub=this.currentBoard$.subscribe(r=>{this.currentBoard=r})}forbiddenNameCheck(r){return this.forbiddenName===r.value?{nameIsForbidden:!0}:null}onSubmit(){const r=this.modalForm.value;this.store.dispatch(this.currentBoard?O({request:r,board:this.currentBoard}):T({request:r})),this.onModalClose()}onModalClose(){this.store.dispatch(C())}ngOnDestroy(){this.currentBoardSub.unsubscribe()}}return o.\u0275fac=function(r){return new(r||o)(t.Y36(u.qu),t.Y36(a.yh))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-board-modal"]],decls:18,vars:8,consts:[[1,"backdrop",3,"click"],[1,"modal",3,"formGroup","ngSubmit"],[1,"name-block"],["for","name"],["type","text","id","name","formControlName","name"],[4,"ngIf"],["for","description"],["cols","41","rows","3","type","text","id","description","formControlName","description"],[1,"modal-controls"],["type","submit",1,"modal-controls__button","modal-controls__button_edit",3,"disabled"]],template:function(r,e){if(1&r&&(t.TgZ(0,"div",0),t.NdJ("click",function(){return e.onModalClose()}),t.qZA(),t.TgZ(1,"form",1),t.NdJ("ngSubmit",function(){return e.onSubmit()}),t.TgZ(2,"div",2)(3,"label",3),t._uU(4),t.qZA(),t._UZ(5,"input",4),t.YNc(6,j,2,0,"span",5),t.YNc(7,Q,2,0,"span",5),t.YNc(8,q,2,0,"span",5),t.qZA(),t.TgZ(9,"div",2)(10,"label",6),t._uU(11,"Board Description"),t.qZA(),t.TgZ(12,"textarea",7),t._uU(13,"    "),t.qZA(),t.YNc(14,K,2,0,"span",5),t.TgZ(15,"div",8)(16,"button",9),t._uU(17),t.qZA()()()()),2&r){let d,s,l,A;t.xp6(1),t.Q6J("formGroup",e.modalForm),t.xp6(3),t.hij("",e.currentBoard?"Edit":null," Board Name"),t.xp6(2),t.Q6J("ngIf",(null==(d=e.modalForm.get("name"))||null==d.value?null:d.value.length)>15),t.xp6(1),t.Q6J("ngIf",(null==(s=e.modalForm.get("name"))||null==s.errors?null:s.errors.required)&&(null==(s=e.modalForm.get("name"))?null:s.touched)),t.xp6(1),t.Q6J("ngIf",(null==(l=e.modalForm.get("name"))||null==l.errors?null:l.errors.nameIsForbidden)&&(null==(l=e.modalForm.get("name"))?null:l.touched)),t.xp6(6),t.Q6J("ngIf",(null==(A=e.modalForm.get("description"))||null==A.value?null:A.value.length)>50),t.xp6(2),t.Q6J("disabled",e.modalForm.invalid),t.xp6(1),t.hij("",e.currentBoard?"Edit":"Add"," Board ")}},dependencies:[h.O5,u._Y,u.Fj,u.JJ,u.JL,u.sg,u.u],changeDetection:0}),o})();var M=c(8505);let V=(()=>{class o{constructor(r,e){this.actions$=r,this.router=e,this.openModal$=(0,i.GW)(()=>this.actions$.pipe((0,i.l4)(v),(0,M.b)(()=>{this.router.navigate(["/dashboard/add-board"])})),{dispatch:!1})}}return o.\u0275fac=function(r){return new(r||o)(t.LFG(i.eX),t.LFG(f.F0))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),o})(),tt=(()=>{class o{constructor(r,e){this.actions$=r,this.router=e,this.closeModal$=(0,i.GW)(()=>this.actions$.pipe((0,i.l4)(C),(0,M.b)(()=>{this.router.navigate(["/dashboard"])})),{dispatch:!1})}}return o.\u0275fac=function(r){return new(r||o)(t.LFG(i.eX),t.LFG(f.F0))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),o})();var g=c(3900),B=c(4004),_=c(2340),ot=c(529);let b=(()=>{class o{constructor(r){this.http=r}fetchBoards(){return this.http.get(_.N.apiUrl+"/boards")}createBoard(r){return this.http.post(_.N.apiUrl+"/boards",r)}editBoard(r,e){return this.http.put(_.N.apiUrl+`/boards/${e}`,r)}deleteBoard(r){return this.http.delete(_.N.apiUrl+`/boards/${r}`)}}return o.\u0275fac=function(r){return new(r||o)(t.LFG(ot.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),o})(),rt=(()=>{class o{constructor(r,e){this.actions$=r,this.dashboardService=e,this.getBoards$=(0,i.GW)(()=>this.actions$.pipe((0,i.l4)(m.H),(0,g.w)(()=>this.dashboardService.fetchBoards().pipe((0,B.U)(d=>(0,m.Q)({boards:d}))))))}}return o.\u0275fac=function(r){return new(r||o)(t.LFG(i.eX),t.LFG(b))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),o})(),et=(()=>{class o{constructor(r,e){this.actions$=r,this.dashboardService=e,this.createBoard$=(0,i.GW)(()=>this.actions$.pipe((0,i.l4)(T),(0,g.w)(({request:d})=>this.dashboardService.createBoard(d).pipe((0,B.U)(s=>Z({board:s}))))))}}return o.\u0275fac=function(r){return new(r||o)(t.LFG(i.eX),t.LFG(b))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),o})(),nt=(()=>{class o{constructor(r,e){this.actions$=r,this.dashboardService=e,this.editBoard$=(0,i.GW)(()=>this.actions$.pipe((0,i.l4)(O),(0,g.w)(({request:d,board:s})=>this.dashboardService.editBoard(d,s?._id).pipe((0,B.U)(()=>{const l={...s,name:d.name,description:d.description};return E({updatedBoard:l})})))))}}return o.\u0275fac=function(r){return new(r||o)(t.LFG(i.eX),t.LFG(b))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),o})(),at=(()=>{class o{constructor(r,e){this.actions$=r,this.dashboardService=e,this.deleteBoard$=(0,i.GW)(()=>this.actions$.pipe((0,i.l4)(P),(0,g.w)(({currentBoard:d})=>this.dashboardService.deleteBoard(d._id).pipe((0,B.U)(()=>x({currentBoard:d}))))))}}return o.\u0275fac=function(r){return new(r||o)(t.LFG(i.eX),t.LFG(b))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),o})(),dt=(()=>{class o{constructor(r,e){this.actions$=r,this.router=e,this.openBoardPage$=(0,i.GW)(()=>this.actions$.pipe((0,i.l4)(k),(0,M.b)(({currentBoard:d})=>{this.router.navigate([`/board/${d._id}`])})),{dispatch:!1})}}return o.\u0275fac=function(r){return new(r||o)(t.LFG(i.eX),t.LFG(f.F0))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),o})();const st=[{path:"",component:X,canActivate:[F.a],children:[{path:"add-board",component:W,canActivate:[F.a]}]}];let it=(()=>{class o{}return o.\u0275fac=function(r){return new(r||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({providers:[b],imports:[h.ez,f.Bz.forChild(st),U.V,u.UX,a.Aw.forFeature("dashboard",Y),i.sQ.forFeature([rt,et,V,tt,nt,at,dt])]}),o})()}}]);